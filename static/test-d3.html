<!DOCTYPE html>
<html lang="en">
  <head>
    <meta chartset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Hibiki</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/17.0.2/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/17.0.2/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mobx/5.15.4/mobx.umd.min.js"></script>
    <script src="/dist/hibiki-dev.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body>
    <template hibiki>
      <hibiki-data>
        {"mode": "scatter"}
      </hibiki-data>
      <import-library src="/libs/d3.html" prefix="d3"></import-library>
      <hibiki-config>
        {
            "modules": {"app": {"type": "http", "baseUrl": "https://testapi.hibikihtml.com/"}}
        }
      </hibiki-config>
      <h-data name="get-data" query="//@app/api/d3-test" load.handler="$.data = @value.data; //@lib-d3/render(data=$.data)"></h-data>
      <section class="hero is-primary mb-3">
        <div class="hero-body">
          <h1 class="title">D3 Test</h1>
        </div>
      </section>
      <div class="container">
        <div class="columns">
          <div class="column is-2">
            <div class="select">
              <select value.bindpath="$.mode">
                <option value="scatter">Scatter</option>
                <option value="table">Table</option>
              </select>
            </div>
          </div>
          <div class="column is-2">
            <button class="button is-secondary" click.handler="invalidate;">Regen Data</button>
          </div>
        </div>
        <table class="table is-striped is-bordered" if="$.mode == 'table'" style="width: 800px;">
          <thead>
            <tr>
              <th>#</th>
              <th>X</th>
              <th>Y</th>
              <th>Val</th>
              <th>Color</th>
            </tr>
          </thead>
          <tbody>
            <tr foreach="(@point, @index) in $.data">
              <td><h-text bind="@index+1"></h-text></td>
              <td><h-text bind="@point.x"></h-text></td>
              <td><h-text bind="@point.y"></h-text></td>
              <td><h-text bind="@point.val"></h-text></td>
              <td style="display:flex; align-items: center;">
                <div style="width:15px; height:15px; background-color: *@point.color; margin-right: 5px;"></div>
                <h-text bind="@point.color"></h-text>
              </td>
            </tr>
          </tbody>
        </table>
        <div style="display: *($.mode == 'scatter' ? 'block' : 'none')">
          <d3-scatter-plot data="*$.data"></d3-scatter-plot>
        </div>
      </div>
    </template>
  </body>
</html>

